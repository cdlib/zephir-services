# COB transformer
from utils import *

source_fieldnames = [
        "Manuscript Name",
        "Manuscript DOI",
        "PII",
        "Manuscript ID",
        "CCC Manuscript ID",
        "Other Manuscript ID",
        "External Reference ID",
        "Manuscript Type",
        "Primary Author First Name",
        "Primary Author Middle Name",
        "Primary Author Last Name",
        "Primary Author Email Address",
        "Number of Pages",
        "Number of Color Figures",
        "Publication Name",
        "Publication ID",
        "Publication DOI",
        "Author Country",
        "ORCID",
        "RESEARCHERID",
        "Membership Name",
        "Geographic Location - used for discount",
        "Institution Identifier - from manuscript metadata",
        "Institution Name - from manuscript metadata",
        "Institution Affiliation - Ringgold ID",
        "Institution Affiliation - Ringgold Name",
        "Institution Affiliation used for discount - Ringgold ID",
        "Institution Affiliation used for discount - Ringgold Name",
        "Creative Commons License Type",
        "Other License Type",
        "Volume",
        "Issue",
        "Publisher Name",
        "Society Name",
        "Submission Date",
        "Date Manuscript Accepted",
        "Target Publication Date",
        "Target OA Publication Date",
        "Order Date",
        "Order ID",
        "Ordered By",
        "Order Reference Number",
        "Transaction Type",
        "Total Tax / VAT %",
        "Total Order Amount",
        "Currency",
        "Product 1 Name",
        "Product 1 Option 1",
        "Product 1 Option 1 Value",
        "Product 1 Option 1 Amount Before Discounts",
        "Product 1 Option 2",
        "Product 1 Option 2 Value",
        "Product 1 Option 2 Amount Before Discounts",
        "Product 1 Option 3",
        "Product 1 Option 3 Value",
        "Product 1 Option 3 Amount Before Discounts",
        "Product 1 Original Amount - before discounts",
        "Product 1 Geographic Discount",
        "Product 1 Membership Discount",
        "Product 1 Affiliation Discount",
        "Product 1 Promo Code Discount",
        "Product 1 Subtotal - before taxes",
        "Product 1 tax/VAT Percentage",
        "Product 1 Tax Amount",
        "Product 2 Name",
        "Product 2 Option 1",
        "Product 2 Option 1 Value",
        "Product 2 Option 1 Amount Before Discounts",
        "Product 2 Option 2",
        "Product 2 Option 2 Value",
        "Product 2 Option 2 Amount Before Discounts",
        "Product 2 Option 3",
        "Product 2 Option 3 Value",
        "Product 2 Option 3 Amount Before Discounts",
        "Product 2 Original Amount - before discounts",
        "Product 2 Geographic Discount",
        "Product 2 Membership Discount",
        "Product 2 Affiliation Discount",
        "Product 2 Promo Code Discount",
        "Product 2 Subtotal - before taxes",
        "Product 2 tax/VAT Percentage",
        "Product 2 Tax Amount",
        "Product 3 Name",
        "Product 3 Option 1",
        "Product 3 Option 1 Value",
        "Product 3 Option 1 Amount Before Discounts",
        "Product 3 Option 2",
        "Product 3 Option 2 Value",
        "Product 3 Option 2 Amount Before Discounts",
        "Product 3 Option 3",
        "Product 3 Option 3 Value",
        "Product 3 Option 3 Amount Before Discounts",
        "Product 3 Original Amount - before discounts",
        "Product 3 Geographic Discount",
        "Product 3 Membership Discount",
        "Product 3 Affiliation Discount",
        "Product 3 Promo Code Discount",
        "Product 3 Subtotal - before taxes",
        "Product 3 tax/VAT Percentage",
        "Product 3 Tax Amount",
        "Product 4 Name",
        "Product 4 Option 1",
        "Product 4 Option 1 Value",
        "Product 4 Option 1 Amount Before Discounts",
        "Product 4 Option 2",
        "Product 4 Option 2 Value",
        "Product 4 Option 2 Amount Before Discounts",
        "Product 4 Option 3",
        "Product 4 Option 3 Value",
        "Product 4 Option 3 Amount Before Discounts",
        "Product 4 Original Amount - before discounts",
        "Product 4 Geographic Discount",
        "Product 4 Membership Discount",
        "Product 4 Affiliation Discount",
        "Product 4 Promo Code Discount",
        "Product 4 Subtotal - before taxes",
        "Product 4 tax/VAT Percentage",
        "Product 4 Tax Amount",
        "Taxable Address",
        "Taxable Address Country",
        "Taxable Address State or Province",
        "Shipping Address",
        "Promotion Name",
        "Promotion Code(s) Applied",
        "Promotion Code(s) from manuscript metadata",
        "Total Discount",
        "Funding Request Profile Name",
        "Agreement Name",
        "Funding Status",
        "Funding Status Update Date",
        "Funding Deny Reason",
        "Funding Deny Reason Details",
        "Invoice Number",
        "Invoice Sequence No.",
        "Invoice Date",
        "Invoice Link",
        "Account No.",
        "Transaction Status",
        "Payment Method",
        "Payment Status",
        "Payment Close Date",
        "Payment Close Reason",
        "Payment Close Reason Updated",
        "Order Confirmation",
        "Funder 1 Name",
        ]


def source_to_output_mapping(src_row, output_row):
    output_row['Publisher'] = "CoB"
    output_row['DOI'] = src_row['Manuscript DOI']
    output_row['Article Title'] = src_row['Manuscript Name']
    output_row['Corresponding Author'] = "{} {} {}".format(src_row['Primary Author First Name'], src_row['Primary Author Middle Name'], src_row['Primary Author Last Name'])
    output_row['Corresponding Author Email'] = src_row['Primary Author Email Address']
    output_row['Document Type'] = src_row['Manuscript Type']
    output_row['Eligible'] = "Yes"
    output_row['Inclusion Date'] = src_row['Date Manuscript Accepted']
    output_row['Article Access Type'] = "OA"
    output_row['Article License'] = src_row['Creative Commons License Type']
    output_row['Journal Name'] = src_row['Publication Name']
    output_row['ISSN/eISSN'] = src_row['Publication ID']
    output_row['Grant Participation'] = src_row['Product 1 Option 2 Value']
    output_row['Funder Information'] = src_row['Funder 1 Name']
    output_row['Full Coverage Reason'] = src_row['Product 1 Option 3 Value']
    output_row['Library APC Portion (USD)'] = str_to_decimal(src_row['Total Discount'])

